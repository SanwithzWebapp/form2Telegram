const token = 'XXXXXXXX';  // Telegram bot token
const chatId = 'XXXXXXXX';   // Telegram chat ID

function chart2TelegramQuick() {
  const data = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("chart").getRange("B2:B4").getValues().flat();
  const wait = data[0];        // ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
  const process = data[1];  // ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
  const done = data[2];        // ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß

  const imageUrl = `https://quickchart.io/chart?c={type:'bar',data:{labels:['‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£','‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£','‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß'],datasets:[{label:'‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°',data:[${wait},${process},${done}],backgroundColor:['Orange','Blue','Green']}]},options:{layout:{padding:30},plugins:{backgroundColor:'white'}}}`;
  
  sendTelegramNotify(`üìä *This is Example Chart*\n\nHere is the latest chart for status updates.`, imageUrl);
}

function sendTelegramNotify(message, imageUrl) {
  UrlFetchApp.fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
    method: 'post',
    contentType: 'application/json',
    payload: JSON.stringify({
    chat_id: chatId,
    caption: message,
    photo: imageUrl,
    parse_mode: 'Markdown'
  }) 
  });
}



// EXAMPLE
// https://quickchart.io/chart?c={type:'bar',data:{labels:['‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£','‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£','‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß'],datasets:[{label:'‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°',data:[10,15,8],backgroundColor:['Orange','Blue','Green']}]},options:{layout:{padding:30},plugins:{backgroundColor:'white'}}}


// DOC : https://quickchart.io/documentation
